<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego</title>
</head>

<body>
    <h1>Camino del Juego</h1>
    <canvas id="canvas" width="1500" height="800"></canvas>

    <script>
        // === OBTENER CANVAS ===
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // === DATOS DESDE DJANGO ===
        const paredes = {{ paredes|safe }};
        const personaje = {
            x: {{ personaje.x }},
            y: {{ personaje.y }},
            imagen: "{{ personaje.imagen }}",
        };

        // === CARGAR IMAGEN DEL PERSONAJE ===
        const img = new Image();
        img.src = personaje.imagen;

        img.onload = function () {
            dibujarTodo();
        };

        // === FUNCIÃ“N QUE DIBUJA TODAS LAS COSAS ===
        function dibujarTodo() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Dibujar paredes
            paredes.forEach(p => {
                ctx.beginPath();
                ctx.moveTo(p.x1, p.y1);
                ctx.lineTo(p.x2, p.y2);
                ctx.strokeStyle = "black";
                ctx.lineWidth = 5;
                ctx.stroke();
            });

            // Dibujar personaje
            ctx.drawImage(img, personaje.x, personaje.y, 50, 50);
        }

        // === MOVIMIENTO DEL PERSONAJE ===
        document.addEventListener("keydown", function (event) {
            if (event.key === "w") personaje.y -= 10;
            if (event.key === "s") personaje.y += 10;
            if (event.key === "a") personaje.x -= 10;
            if (event.key === "d") personaje.x += 10;

            dibujarTodo();
        });

    </script>

</body>
</html>
